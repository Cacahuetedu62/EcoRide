<IfModule mod_headers.c>
    # En-têtes de sécurité de base
    Header always set Permissions-Policy "geolocation=(self),midi=(self),sync-xhr=(self),microphone=(self),camera=(self),magnetometer=(self),gyroscope=(self),fullscreen=(self),payment=(self)"
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-src 'self'; object-src 'none'; base-uri 'self';"
    Header always set Referrer-Policy "no-referrer"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"

    # Masquer les informations sensibles
    Header always unset Server
    Header always unset X-Powered-By
    RequestHeader unset X-Forwarded-For
    Header always unset X-Forwarded-For

    # Protection contre la fuite d'IP
    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^localhost [NC]
    RewriteRule ^(.*)$ http://localhost/$1 [R=301,L]
</IfModule>